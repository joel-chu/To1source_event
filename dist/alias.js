!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).NBEventService=e()}(this,function(){"use strict";var t=new Map,e=new Map,o=function(t){void 0===t&&(t={}),t.logger&&"function"==typeof t.logger&&(this.logger=t.logger),this.result=null,this.normalStore=new Map,this.lazyStore=new Map},r={$done:{configurable:!0},normalStore:{configurable:!0},lazyStore:{configurable:!0}};return o.prototype.logger=function(){},o.prototype.$on=function(t,e,o){var r=this;void 0===o&&(o=null);this.validate(t,e);var n=this.takeFromStore(t);if(!1===n)return this.logger("$on",t+" callback is not in lazy store"),this.addToNormalStore(t,"on",e,o);this.logger("$on",t+" found in lazy store");var i=0;return n.forEach(function(n){var a=n[0],s=n[1];r.run(e,a,o||s),i+=r.addToNormalStore(t,"on",e,o||s)}),i},o.prototype.$once=function(t,e,o){this.validate(t,e);var r=this.takeFromStore(t);if(!1===r&&!this.normalStore.has(t))return this.addToNormalStore(t,"once",e,o);var n=r[0],i=r[1];this.run(e,n,o||i)},o.prototype.$trigger=function(t,e,o){var r=this;void 0===e&&(e=[]),void 0===o&&(o=null),this.validateEvt(t);var n=0,i=this.normalStore;return i.has(t)?(i.get(t).forEach(function(a){++n;var s=a[0],l=a[1],u=a[2];if(r.run(s,e,o||l),"once"===u)return i.delete(t),n}),n):(this.addToLazyStore(t,e,o),n)},o.prototype.$call=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return Reflect.apply(this.$trigger,this,t)},o.prototype.$off=function(t){this.validateEvt(t);var e=[this.lazyStore,this.normalStore],o=!1;return e.forEach(function(e){e.has(t)&&(o=!0,e.delete(t))}),o},o.prototype.$get=function(t){this.validateEvt(t);var e=[],o=this.normalStore;return!!o.has(t)&&(o.get(t).forEach(function(t){var o=t[0];e.push(o)}),e)},r.$done.set=function(t){this.result=t},r.$done.get=function(){return this.result},o.prototype.validateEvt=function(t){if("string"==typeof t)return!0;throw new Error("event name must be string type!")},o.prototype.validate=function(t,e){if(this.validateEvt(t)&&"function"==typeof e)return!0;throw new Error("callback required to be function type!")},o.prototype.run=function(t,e,o){this.logger(t),this.logger(e),this.logger(o),Reflect.apply(t,o,this.toArray(e))},o.prototype.takeFromStore=function(t,e){void 0===e&&(e="lazyStore");var o=this[e];if(this.logger(e,o),o.has(t)){var r=o.get(t);return o.delete(t),r}return!1},o.prototype.addToStore=function(t,e){for(var o,r=[],n=arguments.length-2;n-- >0;)r[n]=arguments[n+2];t.has(e)?(this.logger(e+" existed"),o=t.get(e)):(this.logger("create new Set for "+e),o=new Set),this.logger(r);var i=o.has(r);return this.logger("checking is this existed ["+i+"]"),o.add(r),t.set(e,o),[t,o.size]},o.prototype.addToNormalStore=function(t,e,o,r){this.logger(t,e,"add to normal store");var n=this.addToStore(this.normalStore,t,o,r,e),i=n[0],a=n[1];return this.normalStore=i,a},o.prototype.addToLazyStore=function(t,e,o){void 0===e&&(e=[]),void 0===o&&(o=null);var r=this.addToStore(this.lazyStore,t,this.toArray(e),o),n=r[0],i=r[1];return this.lazyStore=n,i},o.prototype.toArray=function(t){return Array.isArray(t)?t:[t]},r.normalStore.set=function(e){t.set(this,e)},r.normalStore.get=function(){return t.get(this)},r.lazyStore.set=function(t){e.set(this,t)},r.lazyStore.get=function(){return e.get(this)},Object.defineProperties(o.prototype,r),function(t){function e(e){void 0===e&&(e={}),t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.on=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return Reflect.apply(this.$on,this,t)},e.prototype.off=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return Reflect.apply(this.$off,this,t)},e.prototype.emit=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return Reflect.apply(this.$trigger,this,t)},e.prototype.once=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return Reflect.apply(this.$once,this,t)},e}(o)});
//# sourceMappingURL=alias.js.map
